<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- Gradients for 3D surface effect -->
    <linearGradient id="surfaceGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1e3c72;stop-opacity:0.9"/>
      <stop offset="50%" style="stop-color:#2a5298;stop-opacity:0.8"/>
      <stop offset="100%" style="stop-color:#7e8ba3;stop-opacity:0.7"/>
    </linearGradient>
    
    <linearGradient id="riskGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#2166ac;stop-opacity:1"/>
      <stop offset="25%" style="stop-color:#4393c3;stop-opacity:1"/>
      <stop offset="50%" style="stop-color:#92c5de;stop-opacity:1"/>
      <stop offset="75%" style="stop-color:#fddbc7;stop-opacity:1"/>
      <stop offset="100%" style="stop-color:#b2182b;stop-opacity:1"/>
    </linearGradient>
    
    <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="2"/>
      <feOffset dx="1" dy="1"/>
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.3"/>
      </feComponentTransfer>
      <feMerge>
        <feMergeNode/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    
    <pattern id="gridPattern" patternUnits="userSpaceOnUse" width="20" height="20">
      <line x1="0" y1="0" x2="0" y2="20" stroke="#e0e0e0" stroke-width="0.5"/>
      <line x1="0" y1="0" x2="20" y2="0" stroke="#e0e0e0" stroke-width="0.5"/>
    </pattern>
  </defs>
  
  <!-- Background -->
  <rect x="0" y="0" width="1200" height="800" fill="#ffffff"/>
  
  <!-- Title -->
  <text x="600" y="35" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="24" font-weight="bold" fill="#1a1a1a">
    Distributed Lag Non-linear Model (DLNM) Methodology
  </text>
  
  <text x="600" y="60" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="14" fill="#4a4a4a">
    Temperature-Lag-Response Surface for Health Outcomes
  </text>
  
  <!-- 3D Conceptual Framework -->
  <g id="3d-framework" transform="translate(100, 100)">
    <text x="200" y="-10" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      A. Exposure-Lag-Response Surface
    </text>
    
    <!-- 3D axes -->
    <!-- Temperature axis (X) -->
    <line x1="50" y1="250" x2="350" y2="250" stroke="#333333" stroke-width="2" marker-end="url(#arrowhead)"/>
    <text x="200" y="280" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="12" fill="#333333">
      Temperature (°C)
    </text>
    
    <!-- Lag axis (Y) -->
    <line x1="50" y1="250" x2="150" y2="150" stroke="#333333" stroke-width="2"/>
    <text x="100" y="130" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="12" fill="#333333">
      Lag (days)
    </text>
    
    <!-- Response axis (Z) -->
    <line x1="50" y1="250" x2="50" y2="50" stroke="#333333" stroke-width="2"/>
    <text x="25" y="45" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="12" fill="#333333">
      RR
    </text>
    
    <!-- 3D surface representation -->
    <path d="M 80,220 Q 200,180 320,220 L 420,120 Q 300,80 180,120 Z" 
          fill="url(#surfaceGradient)" opacity="0.7" filter="url(#shadow)"/>
    
    <!-- Grid lines on surface -->
    <g stroke="#ffffff" stroke-width="0.5" opacity="0.5">
      <line x1="100" y1="200" x2="200" y2="100"/>
      <line x1="150" y1="210" x2="250" y2="110"/>
      <line x1="200" y1="220" x2="300" y2="120"/>
      <line x1="250" y1="210" x2="350" y2="110"/>
      
      <line x1="120" y1="180" x2="320" y2="180"/>
      <line x1="140" y1="160" x2="340" y2="160"/>
      <line x1="160" y1="140" x2="360" y2="140"/>
    </g>
    
    <!-- Axis labels -->
    <g font-family="Helvetica, Arial, sans-serif" font-size="10" fill="#666666">
      <text x="70" y="265">15</text>
      <text x="150" y="265">20</text>
      <text x="230" y="265">25</text>
      <text x="310" y="265">30</text>
      
      <text x="30" y="250">1.0</text>
      <text x="30" y="200">1.5</text>
      <text x="30" y="150">2.0</text>
      <text x="30" y="100">2.5</text>
      
      <text x="70" y="240">0</text>
      <text x="90" y="220">7</text>
      <text x="110" y="200">14</text>
      <text x="130" y="180">21</text>
    </g>
  </g>
  
  <!-- Cross-basis Functions -->
  <g id="cross-basis" transform="translate(550, 100)">
    <text x="275" y="-10" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      B. Cross-basis Functions
    </text>
    
    <!-- Temperature basis -->
    <g transform="translate(0, 30)">
      <text x="0" y="0" font-family="Helvetica, Arial, sans-serif" font-size="12" font-weight="bold" fill="#333333">
        Temperature Basis
      </text>
      <text x="0" y="20" font-family="Helvetica, Arial, sans-serif" font-size="11" fill="#666666">
        Natural cubic splines
      </text>
      
      <!-- Spline curves -->
      <g transform="translate(0, 40)">
        <rect x="0" y="0" width="200" height="80" fill="url(#gridPattern)" stroke="#cccccc" stroke-width="1"/>
        
        <!-- Knot positions -->
        <circle cx="20" cy="60" r="3" fill="#d62728"/>
        <circle cx="50" cy="60" r="3" fill="#d62728"/>
        <circle cx="150" cy="60" r="3" fill="#d62728"/>
        <circle cx="180" cy="60" r="3" fill="#d62728"/>
        
        <!-- Spline curves -->
        <path d="M 0,70 Q 20,30 50,40 T 100,35 Q 150,30 200,60" 
              stroke="#2166ac" stroke-width="2" fill="none"/>
        <path d="M 0,60 Q 30,70 60,50 T 120,65 Q 160,70 200,40" 
              stroke="#4393c3" stroke-width="2" fill="none"/>
        <path d="M 0,50 Q 40,60 80,70 T 140,55 Q 170,50 200,30" 
              stroke="#92c5de" stroke-width="2" fill="none"/>
        
        <!-- Labels -->
        <text x="20" y="95" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="9" fill="#666666">
          10th
        </text>
        <text x="50" y="95" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="9" fill="#666666">
          25th
        </text>
        <text x="150" y="95" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="9" fill="#666666">
          90th
        </text>
        <text x="180" y="95" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="9" fill="#666666">
          95th
        </text>
      </g>
    </g>
    
    <!-- Lag basis -->
    <g transform="translate(250, 30)">
      <text x="0" y="0" font-family="Helvetica, Arial, sans-serif" font-size="12" font-weight="bold" fill="#333333">
        Lag Basis
      </text>
      <text x="0" y="20" font-family="Helvetica, Arial, sans-serif" font-size="11" fill="#666666">
        Natural cubic splines (df=4)
      </text>
      
      <!-- Lag structure visualization -->
      <g transform="translate(0, 40)">
        <rect x="0" y="0" width="200" height="80" fill="url(#gridPattern)" stroke="#cccccc" stroke-width="1"/>
        
        <!-- Lag periods -->
        <rect x="0" y="20" width="30" height="40" fill="#2166ac" opacity="0.3"/>
        <rect x="70" y="20" width="70" height="40" fill="#4393c3" opacity="0.3"/>
        <rect x="0" y="20" width="200" height="40" fill="none" stroke="#92c5de" stroke-width="2" stroke-dasharray="5,3"/>
        
        <text x="15" y="45" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="10" fill="#ffffff">
          0-3
        </text>
        <text x="105" y="45" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="10" fill="#ffffff">
          7-14
        </text>
        <text x="100" y="10" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="10" fill="#333333">
          0-21 days (Cumulative)
        </text>
        
        <!-- Labels -->
        <text x="15" y="75" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="9" fill="#666666">
          Immediate
        </text>
        <text x="105" y="75" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="9" fill="#666666">
          Delayed
        </text>
      </g>
    </g>
    
    <!-- Mathematical notation -->
    <g transform="translate(100, 200)">
      <rect x="-10" y="-5" width="320" height="30" fill="#f8f8f8" stroke="#cccccc" stroke-width="1" rx="3"/>
      <text x="150" y="10" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="11" fill="#333333">
        η(x,l) = Σ f(x) × g(l) × β
      </text>
      <text x="150" y="22" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="9" fill="#666666" font-style="italic">
        where x = temperature, l = lag, β = coefficients
      </text>
    </g>
  </g>
  
  <!-- Temperature-Response Curves -->
  <g id="temp-response" transform="translate(100, 450)">
    <text x="500" y="-10" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
      C. Temperature-Response Relationship
    </text>
    
    <!-- Main plot area -->
    <rect x="50" y="20" width="900" height="250" fill="#fafafa" stroke="#333333" stroke-width="1.5"/>
    
    <!-- Grid -->
    <g stroke="#e0e0e0" stroke-width="0.5">
      <line x1="50" y1="70" x2="950" y2="70"/>
      <line x1="50" y1="120" x2="950" y2="120"/>
      <line x1="50" y1="170" x2="950" y2="170"/>
      <line x1="50" y1="220" x2="950" y2="220"/>
      
      <line x1="200" y1="20" x2="200" y2="270"/>
      <line x1="350" y1="20" x2="350" y2="270"/>
      <line x1="500" y1="20" x2="500" y2="270"/>
      <line x1="650" y1="20" x2="650" y2="270"/>
      <line x1="800" y1="20" x2="800" y2="270"/>
    </g>
    
    <!-- Reference line at RR=1 -->
    <line x1="50" y1="170" x2="950" y2="170" stroke="#666666" stroke-width="1.5" stroke-dasharray="5,5"/>
    
    <!-- Temperature-response curve -->
    <path d="M 50,170 Q 200,165 350,170 Q 500,175 650,185 Q 750,200 850,240 Q 900,260 950,270" 
          stroke="url(#riskGradient)" stroke-width="3" fill="none"/>
    
    <!-- Confidence interval -->
    <path d="M 50,165 Q 200,158 350,162 Q 500,165 650,172 Q 750,185 850,225 Q 900,245 950,260
             L 950,280 Q 900,275 850,255 Q 750,215 650,198 Q 500,185 350,178 Q 200,172 50,175 Z" 
          fill="#2166ac" opacity="0.15"/>
    
    <!-- Reference temperature marker -->
    <line x1="500" y1="20" x2="500" y2="270" stroke="#ff7f0e" stroke-width="2" stroke-dasharray="8,4"/>
    <circle cx="500" cy="170" r="5" fill="#ff7f0e"/>
    
    <!-- Risk threshold markers -->
    <line x1="750" y1="20" x2="750" y2="270" stroke="#d62728" stroke-width="1.5" stroke-dasharray="4,2" opacity="0.7"/>
    <line x1="850" y1="20" x2="850" y2="270" stroke="#d62728" stroke-width="1.5" stroke-dasharray="4,2" opacity="0.7"/>
    
    <!-- Axes labels -->
    <text x="500" y="300" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="12" fill="#333333">
      Temperature (°C)
    </text>
    
    <text x="20" y="150" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="12" fill="#333333" transform="rotate(-90 20 150)">
      Relative Risk
    </text>
    
    <!-- X-axis labels -->
    <g font-family="Helvetica, Arial, sans-serif" font-size="10" fill="#666666">
      <text x="50" y="285" text-anchor="middle">10</text>
      <text x="200" y="285" text-anchor="middle">15</text>
      <text x="350" y="285" text-anchor="middle">18</text>
      <text x="500" y="285" text-anchor="middle">21</text>
      <text x="650" y="285" text-anchor="middle">24</text>
      <text x="750" y="285" text-anchor="middle">26.2</text>
      <text x="850" y="285" text-anchor="middle">27.1</text>
      <text x="950" y="285" text-anchor="middle">30</text>
    </g>
    
    <!-- Y-axis labels -->
    <g font-family="Helvetica, Arial, sans-serif" font-size="10" fill="#666666">
      <text x="40" y="270" text-anchor="end">0.5</text>
      <text x="40" y="220" text-anchor="end">0.75</text>
      <text x="40" y="170" text-anchor="end">1.0</text>
      <text x="40" y="120" text-anchor="end">1.25</text>
      <text x="40" y="70" text-anchor="end">1.5</text>
      <text x="40" y="20" text-anchor="end">1.75</text>
    </g>
    
    <!-- Annotations -->
    <g font-family="Helvetica, Arial, sans-serif" font-size="11">
      <text x="500" y="10" text-anchor="middle" fill="#ff7f0e">
        Reference: 21°C
      </text>
      <text x="750" y="10" text-anchor="middle" fill="#d62728">
        90th: 26.2°C
      </text>
      <text x="850" y="10" text-anchor="middle" fill="#d62728">
        95th: 27.1°C
      </text>
    </g>
  </g>
  
  <!-- Key Parameters Box -->
  <g id="parameters" transform="translate(850, 350)">
    <rect x="0" y="0" width="300" height="120" fill="#f8f8f8" stroke="#666666" stroke-width="1" rx="5"/>
    
    <text x="150" y="20" text-anchor="middle" font-family="Helvetica, Arial, sans-serif" font-size="13" font-weight="bold" fill="#333333">
      Model Parameters
    </text>
    
    <g font-family="Helvetica, Arial, sans-serif" font-size="11" fill="#555555">
      <text x="10" y="40">• Temperature: Natural cubic splines (3 df)</text>
      <text x="10" y="55">• Knots: 10th, 25th, 90th percentiles</text>
      <text x="10" y="70">• Lag: Natural cubic splines (4 df)</text>
      <text x="10" y="85">• Maximum lag: 21 days</text>
      <text x="10" y="100">• Reference temperature: 21°C (median)</text>
      <text x="10" y="115">• Adjustment: Time trends, seasonality</text>
    </g>
  </g>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333333"/>
    </marker>
  </defs>
</svg>